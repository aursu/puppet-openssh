### THIS FILE IS MANAGED BY PUPPET. DO NOT EDIT THIS FILE. ###

<% if @setup_host_key %>
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

<% end %>
SyslogFacility AUTHPRIV
LoginGraceTime 60
PermitRootLogin <%= @permit_root_login %>

MaxAuthTries 20
MaxSessions 5

PubkeyAuthentication yes
<% if @keys_file %>
AuthorizedKeysFile <%= @keys_file %>
<% end %>

PasswordAuthentication <%= @password_authentication %>
PermitEmptyPasswords no
ChallengeResponseAuthentication <%= @challenge_response_authentication %>
GSSAPIAuthentication <%= @gss_api_authentication %>
GSSAPICleanupCredentials yes
UsePAM yes
X11Forwarding no
UsePrivilegeSeparation <%= @use_privilege_separation %>

AcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES
AcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT
AcceptEnv LC_IDENTIFICATION LC_ALL LANGUAGE
AcceptEnv XMODIFIERS

Subsystem sftp /usr/libexec/openssh/sftp-server -f AUTHPRIV -l INFO

Port <%= @ssh_port %>
StrictModes <%= @strict_modes %>
HostbasedAuthentication <%= @hostbased_authentication %>
IgnoreRhosts yes

AllowTcpForwarding <%= @allow_tcp_forwarding %>
<% if @banner %>
Banner <%= @banner %>
<% end %>
PermitTunnel <%= @permit_tunnel %>
<% if @kexalgorithms %>
KexAlgorithms <%= Array(@kexalgorithms).join(',') %>
<% end %>
<% if @macs %>
MACs <%= Array(@macs).join(',') %>
<% end %>
<% if @ciphers %>
Ciphers <%= Array(@ciphers).join(',') %>
<% end %>
